/**
 * CoffeeScript Compiler v1.2.0n
 * http://coffeescript.org
 *
 * Copyright 2011, Jeremy Ashkenas
 * Released under the MIT License
 */
(function(a){var b=function(){function a(b){return a[b]}return a["./iced"]=new function(){var a=this;((function(){var b,c,d,e,f,g,h,i,j,k,l,m=[].slice;a.transform=function(a){return a.icedTransform()},a["const"]=b={k:"__iced_k",param:"__iced_p_",ns:"iced",Deferrals:"Deferrals",deferrals:"__iced_deferrals",fulfill:"_fulfill",b_while:"_break",t_while:"_while",c_while:"_continue",n_while:"_next",n_arg:"__iced_next_arg",defer_method:"defer",slot:"__slot",assign_fn:"assign_fn",runtime:"icedrun",autocb:"autocb",retslot:"ret",trace:"__iced_trace",passed_deferral:"__iced_passed_deferral",findDeferral:"findDeferral",lineno:"lineno",parent:"parent",filename:"filename",funcname:"funcname",catchExceptions:"catchExceptions",runtime_modes:["node","inline","window","none"]},h=function(a,c,d,e){var f,g,h,i;h={};for(f in e)i=e[f],h[f]=i;return h[b.lineno]=c!=null?c[b.lineno]:void 0,g=function(){var b,e;return b=1<=arguments.length?m.call(arguments,0):[],c!=null&&(e=c.assign_fn)!=null&&e.apply(null,b),a._fulfill(d,h)},g[b.trace]=h,g},l=0,j=function(a){return l++,l%a===0?(l=0,!0):!1},k=null,c=function(){function a(a,b){this.trace=b,this.continuation=a,this.count=1,this.ret=null}return a.name="Deferrals",a.prototype._call=function(a){return k=a,this.continuation(this.ret)},a.prototype._fulfill=function(a,b){var c=this;if(--this.count===0)return j(500)?process.nextTick(function(){return c._call(b)}):this._call(b)},a.prototype.defer=function(a){var b;return this.count++,b=this,h(b,a,null,this.trace)},a}(),g=function(a){var c,d,e;for(d=0,e=a.length;d<e;d++){c=a[d];if(c!=null?c[b.trace]:void 0)return c}return null},d=function(){function c(){this.completed=[],this.waiters=[],this.defer_id=0,this[b.deferrals]=this}var a;return c.name="Rendezvous",a=function(){function a(a,b){this.rv=a,this.id=b}return a.name="RvId",a.prototype.defer=function(a){return this.rv._deferWithId(this.id,a)},a}(),c.prototype.wait=function(a){var b;return this.completed.length?(b=this.completed.shift(),a(b)):this.waiters.push(a)},c.prototype.defer=function(a){var b;return b=this.defer_id++,this.deferWithId(b,a)},c.prototype.id=function(c){var d;return d={},d[b.deferrals]=new a(this,c),d},c.prototype._fulfill=function(a,b){var c;return this.waiters.length?(c=this.waiters.shift(),c(a)):this.completed.push(a)},c.prototype._deferWithId=function(a,b){return this.count++,h(this,b,a,{})},c}(),i=function(a){var c,d,e,f,g;e=[],f=a?a[b.trace]:k;while(f)c=f[b.funcname]||"<anonymous>",d="   at "+c+" ("+f[b.filename]+":"+(f[b.lineno]+1)+")",e.push(d),f=f!=null?(g=f[b.parent])!=null?g[b.trace]:void 0:void 0;return e},f=function(a){var b;console.log(a.stack),b=i();if(b.length)return console.log("Iced 'stack' trace (w/ real line numbers):"),console.log(b.join("\n"))},e=function(){return process.on("uncaughtException",function(a){return f(a),process.exit(1)})},a.runtime={Deferrals:c,Rendezvous:d,findDeferral:g,stackWalk:i,exceptionHandler:f,catchExceptions:e}})).call(this)},a["./icedlib"]=new function(){var b=this;((function(){var c,d,e,f,g,h,i,j=[].slice;f=function(){},e=a("./iced"),b.iced=d=e.runtime,i=function(a,b,c,e){var f,g,h,i,k,l=this;i=d.findDeferral(arguments),g=new d.Rendezvous,e[0]=g.id(!0).__iced_deferrals.defer({assign_fn:function(){return function(){return f=j.call(arguments,0)}}(),lineno:17}),setTimeout(g.id(!1).__iced_deferrals.defer({lineno:18}),b),function(a){k=new d.Deferrals(a,{parent:i,filename:"src/icedlib.coffee",funcname:"_timeout"}),g.wait(k.defer({assign_fn:function(){return function(){return h=arguments[0]}}(),lineno:20})),k._fulfill()}(function(){return c&&(c[0]=h),a.apply(null,f)})},b.timeout=function(a,b,c){var d;return d=[],i(a,b,c,d),d[0]},g=function(a,b,c){var e,f,g,h=this;f=d.findDeferral(arguments),function(a){g=new d.Deferrals(a,{parent:f,filename:"src/icedlib.coffee",funcname:"_iand"}),c[0]=g.defer({assign_fn:function(){return function(){return e=arguments[0]}}(),lineno:35}),g._fulfill()}(function(){return e||(b[0]=!1),a()})},b.iand=function(a,b){var c;return c=[],g(a,b,c),c[0]},h=function(a,b,c){var e,f,g,h=this;f=d.findDeferral(arguments),function(a){g=new d.Deferrals(a,{parent:f,filename:"src/icedlib.coffee",funcname:"_ior"}),c[0]=g.defer({assign_fn:function(){return function(){return e=arguments[0]}}(),lineno:50}),g._fulfill()}(function(){return e&&(b[0]=!0),a()})},b.ior=function(a,b){var c;return c=[],h(a,b,c),c[0]},b.Pipeliner=c=function(){function a(a,b){this.window=a||1,this.delay=b||0,this.queue=[],this.n_out=0,this.cb=null,this[e["const"].deferrals]=this,this.defer=this._defer}return a.name="Pipeliner",a.prototype.waitInQueue=function(a){var b,c,e=this;b=d.findDeferral(arguments),function(a){var f,g;f=[],g=function(a){var h,i,j;h=function(){return a(f)},i=function(){return g(a)},j=function(a){return f.push(a),i()};if(!(e.n_out>e.window))return h();(function(a){c=new d.Deferrals(a,{parent:b,filename:"src/icedlib.coffee",funcname:"Pipeliner.waitInQueue"}),e.cb=c.defer({lineno:86}),c._fulfill()})(j)},g(a)}(function(){e.n_out++,function(a){if(!e.delay)return a();(function(a){c=new d.Deferrals(a,{parent:b,filename:"src/icedlib.coffee",funcname:"Pipeliner.waitInQueue"}),setTimeout(c.defer({lineno:94}),e.delay),c._fulfill()})(a)}(function(){return a()})})},a.prototype.__defer=function(a,b){var c,e,f,g,h=this;f=d.findDeferral(arguments),function(c){g=new d.Deferrals(c,{parent:f,filename:"src/icedlib.coffee",funcname:"Pipeliner.__defer"}),e=g.defer({lineno:107}),a[0]=function(){var a,c;return a=1<=arguments.length?j.call(arguments,0):[],(c=b.assign_fn)!=null&&c.apply(null,a),e()},g._fulfill()}(function(){h.n_out--;if(h.cb)return c=h.cb,h.cb=null,c()})},a.prototype._defer=function(a){var b;return b=[],this.__defer(b,a),b[0]},a.prototype.flush=function(a){var b,c,e,g,h=this;f=a,b=d.findDeferral(arguments),e=[],g=function(a){var f,i,j;f=function(){return a(e)},i=function(){return g(a)},j=function(a){return e.push(a),i()};if(!h.n_out)return f();(function(a){c=new d.Deferrals(a,{parent:b,filename:"src/icedlib.coffee",funcname:"Pipeliner.flush"}),h.cb=c.defer({lineno:134}),c._fulfill()})(j)},g(f)},a}()})).call(this)},a["./icedlib"]}();typeof define=="function"&&define.amd?(define(function(){return b}),define(function(){return b.iced})):(a.icedlib=b,a.iced=b.iced)})(this)